function [ elemM ] = masse2dp2(i,p,t)


%définition des noeuds associé à l'élément
x1=p(1,t(1,i));
x2=p(1,t(2,i));
x3=p(1,t(3,i));
y1=p(2,t(1,i));
y2=p(2,t(2,i));
y3=p(2,t(3,i));

%le jacobien :
J=[x2-x1,x3-x1;y2-y1,y3-y1];
I=inv(J);

%les derivées des fonctions de formes : elles sont presente dans le calcul
%suivant apres leurs multiplication par inv(J)

%f1=@(x,y) 4*x+4*y-3;
%g1=@(x,y) 4*y+4*x-3;
%f2=@(x,y) 4*x-1;
%g2=@(x,y) 0;
%f3=@(x,y) 0;
%g3=@(x,y) 4*y-1;
%f4=@(x,y) -8*x-4*y+4;
%g4=@(x,y) -4*x;
%f5=@(x,y) 4*y;
%g5=@(x,y) 4*x;
%f6=@(x,y) -4*y;
%g6=@(x,y) -8*y-4*x+4;


%les éléments de la matrice inv(J)
i1=I(1,1);
i2=I(1,2);
i3=I(2,1);
i4=I(2,2);



c11=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c12=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i1*(4*x-1);i3*(4*x-1)];
c13=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i2*(4*y-1);i4*(4*y-1)];
c14=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c15=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c16=@(x,y) [i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];
c21=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c22=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i1*(4*x-1);i3*(4*x-1)];
c23=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i2*(4*y-1);i4*(4*y-1)];
c24=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c25=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c26=@(x,y) [i1*(4*x-1);i3*(4*x-1)]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];
c31=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c32=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i1*(4*x-1);i3*(4*x-1)];
c33=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i2*(4*y-1);i4*(4*y-1)];
c34=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c35=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c36=@(x,y) [i2*(4*y-1);i4*(4*y-1)]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];
c41=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c42=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i1*(4*x-1);i3*(4*x-1)];
c43=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i2*(4*y-1);i4*(4*y-1)];
c44=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c45=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c46=@(x,y) [i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];
c51=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c52=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i1*(4*x-1);i3*(4*x-1)];
c53=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i2*(4*y-1);i4*(4*y-1)];
c54=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c55=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c56=@(x,y) [i1*4*y+i2*4*x;i3*4*y+i4*4*x]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];
c61=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i1*(4*x+4*y-3)+i2*(4*y+4*x-3);i3*(4*x+4*y-3)+i4*(4*y+4*x-3)];
c62=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i1*(4*x-1);i3*(4*x-1)];
c63=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i2*(4*y-1);i4*(4*y-1)];
c64=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i1*(-8*x-4*y+4)+i2*(-4*x);i3*(-8*x-4*y+4)+i4*(-4*x)];
c65=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i1*4*y+i2*4*x;i3*4*y+i4*4*x];
c66=@(x,y) [i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)]'*[i1*(-4*y)+i2*(-8*y-4*x+4);i3*(-4*y)+i4*(-8*y-4*x+4)];

h=@(x,y) 1;
%Calcul de l'integrale par la quadrature de Gauss 

elemM=det(J)*[gauss2dp2(c11,h),gauss2dp2(c12,h),gauss2dp2(c13,h),gauss2dp2(c14,h),gauss2dp2(c15,h),gauss2dp2(c16,h);
              gauss2dp2(c21,h),gauss2dp2(c22,h),gauss2dp2(c23,h),gauss2dp2(c24,h),gauss2dp2(c25,h),gauss2dp2(c26,h);
              gauss2dp2(c31,h),gauss2dp2(c32,h),gauss2dp2(c33,h),gauss2dp2(c34,h),gauss2dp2(c35,h),gauss2dp2(c36,h);
              gauss2dp2(c41,h),gauss2dp2(c42,h),gauss2dp2(c43,h),gauss2dp2(c44,h),gauss2dp2(c45,h),gauss2dp2(c46,h);
              gauss2dp2(c51,h),gauss2dp2(c52,h),gauss2dp2(c53,h),gauss2dp2(c54,h),gauss2dp2(c55,h),gauss2dp2(c56,h);
              gauss2dp2(c61,h),gauss2dp2(c62,h),gauss2dp2(c63,h),gauss2dp2(c64,h),gauss2dp2(c65,h),gauss2dp2(c66,h)];
          
end

